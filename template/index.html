{% extends 'base.html' %}
{% load static %}
{% block title %}
Booking Slot
{% endblock %}

{% block content %}
<div id="booking" class="section">
	
	<div class="section-center">
		
		<div class="container">
			<div class="row">
				<div class="col-md-7 col-md-push-5">
					<div class="openBtn">
						<!-- <button class="btn add btn-info grp" onclick="openForm()"><strong></strong></button> -->
					  </div><div class="loginPopup">
						<div class="formPopup" id="popupForm">
						  <!-- <form action="add/" method="POST">
							{% csrf_token %}
							<h2>Add Event</h2>
							
							<input type="text" id="task" placeholder="Your task" name="task" required>
							<label for="psw">
								<label for="email">
									<strong>start</strong>
								  </label>

								  <input type="date" id="start"  name="start" required>
								  <input type="time" id="timestart" name="timestart">
								 </label>
								 <label for="psw">
								  <label for="email">
									<strong>end</strong>
								  </label>
								  <input type="date" id="end"  name="end" required>
								  <input type="time" id="timeend" name="timeend">
								 
							</label>
							
							<button type="submit" class="btn">schedule</button>
							<button type="button" class="btn cancel" onclick="closeForm()">Close</button>
						  </form> -->
						  
						</div>
					  </div>
				
					<div class="booking-cta">
						
						<h3 style="color:white; font-family: 'Ubuntu', sans-serif;font-size: 35px;font-weight: bold;" id="demo"></h3>
					</div>
					<div class="container">
						<div class="row">
							{% for new in room1 %}
							<div class="col-4">
								<div class="card" style="width: 75rem;color:white;font-weight: 500;  font: 32px Arial, Helvetica, sans-serif;">
									<div class="card-body" >
										<h2 class="card-title"><strong>TASK : {{new.task}}</strong></h2>
										<!-- <h4 class="card-title"> {{new.task}}</h4> -->
										<p class="card-text">{{new.start}}-{{new.end}}
										</p>

									</div>
								</div>
							</div>
							{%endfor%}
						</div>
					</div>
				</div>

				<div class="col-md-5 col-md-pull-4">
					<div class="booking-form">

						<h3> <strong> MEETING SCHEDULER </strong></h3>
						{% if messages %}


						<div class="messages">

							{% for message in messages %}
							<center>
								<div class="container-fluid p-0">
									<div class="alert {{ message.tags }} alert-dismissible" role="alert">

										{{ message }}
									</div>
								</div>
							</center>
							{% endfor %}
						</div>
						{% endif %}

						<form action='#' id="registration" method='POST'>
							{% csrf_token %}
							<div class="form-group">
								<span class="form-label">Email</span>
								<input name="Email" id="Email" class="form-control" type="text" placeholder="Email" value="{{ email }}">
							</div>
							<div class="form-group">
								<span class="form-label">Task</span>
								<input class="form-control" name="task" id="task" type="text"
									placeholder="Enter your task to schedule">
							</div>
							<div class="form-group">
								<span class="form-label">Description</span>
								<input name="Description" id="Description" class="form-control" type="text"
									placeholder="Task is schedule for">
							</div>
							<div class="row">
								<div class="col-sm-6">
									<div class="form-group">
										<span class="form-label">Start Date</span>
										<input name="start" id="start" class="form-control" type="date"
											required>
									</div>
								</div>
								<div class="col-sm-6">
									<div class="form-group">
										<span class="form-label">End Date</span>
										<input name="end" id="end" class="form-control" type="date" required>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-6">
									<div class="form-group">
										<span class="form-label">Start time</span>
										<input name="starttime" id="starttime" class="form-control" type="time"
											required>
									</div>
								</div>
								<div class="col-sm-6">
									<div class="form-group">
										<span class="form-label">End time</span>
										<input name="endtime" id="endtime" class="form-control" type="time" required>
									</div>
								</div>
							</div>
							<div class="row">
								
									<div class="form-group">
										<label class="toggle">
											<input class="toggle-checkbox" onclick="myFunction()" id="repeated" name="repeated" type="checkbox">
										
											<div class="toggle-switch"></div>
											<span class="toggle-label" >Repeated</span>
										
										  </label>
									</div>
								</div>
								<div class="row" id="repeatedbox" hidden>
								<div class="form-group">
									<span class="form-label">Repeated schedules</span>
									<div class="weekDays-selector">
										<input type="checkbox"  id="weekday-sun" name="Sun" class="weekday" />
										<label style="color:rgb(195, 39, 39);" for="weekday-sun">S</label>
										<input type="checkbox" id="weekday-mon" name="Mon" class="weekday" />
										<label for="weekday-mon">M</label>
										<input type="checkbox" id="weekday-tue" name="Tue" class="weekday" />
										<label for="weekday-tue">T</label>
										<input type="checkbox" id="weekday-wed" name="Wed" class="weekday" />
										<label for="weekday-wed">W</label>
										<input type="checkbox" id="weekday-thu" name="Thu" class="weekday" />
										<label for="weekday-thu">T</label>
										<input type="checkbox" id="weekday-fri" name="Fri" class="weekday" />
										<label for="weekday-fri">F</label>
										<input type="checkbox"  id="weekday-sat" name="Sat" class="weekday" />
										<label style="color:rgb(198, 33, 15);" for="weekday-sat">S</label>
										
									  </div>
	
								</div>
							</div>
							
								<div class="form-btn">
									<a href="/test">
									<center><button class="submit-btn">BOOK SLOT</button><center></a> 
								</div>

						</form>
					</div>
				</div>
				<script>
					
				</script>
			<script>
				function myFunction() {
				var x = document.getElementById("repeatedbox");
				if (x.style.display === "block") {
					x.style.display = "none";
				}else {
					x.style.display = "block";
				}
				}
				</script>
			
			
				<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
				
				<script>
					// Set the date we're counting down to
					var countDownDate = new Date({{central.year}},{{central.month}},{{central.day}},{{central.hour}},{{central.minute}},{{central.second}}).getTime();
					
					
					// Update the count down every 1 second
					var x = setInterval(function() {
					
					  // Get today's date and time
					  var now = new Date().getTime();
					
					  // Find the distance between now and the count down date
					  var distance = countDownDate - now;
					 
					  // Time calculations for days, hours, minutes and seconds
					  var days = Math.floor(distance / (1000 * 60 * 60 * 24));
					  var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
					  var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
					  var seconds = Math.floor((distance % (1000 * 60)) / 1000);
					
					  // Display the result in the element with id="demo"
					//   document.getElementById("demo").innerHTML = days + "d " + hours + "h "
					//   + minutes + "m " + seconds + "s ";
					  document.getElementById("demo").innerHTML = "NEXT SLOT AVAILABLE: "+ hours + "H "
					  + minutes + "M " + seconds + "S ";
					
					  // If the count down is finished, write some text
					  if (hours == 0 && minutes==0 && seconds==0) {
						clearInterval(x);
						document.getElementById("demo").innerHTML = "SLOT AVAILABLE";
					  }
					}, 1000);
					</script>
					<script>



						$(function(){
							jQuery.validator.addMethod("greaterThan", 
							function(value, element, params) {

								if (!/Invalid|NaN/.test(new Date(value))) {
									return new Date(value) >= new Date($(params).val());
								}

								return isNaN(value) && isNaN($(params).val()) 
									|| (Number(value) > Number($(params).val())); 
							},'Must be greater than {0}.');
							
						  var $registrationForm = $('#registration');
						  if($registrationForm.length){
						  $registrationForm.validate({
							 rules:{ 
								Email: {
									  required: true,
									  email:true
									  
									  
								  },
								  task: {
									  required:  true,
									
									
								  },
								  Description: {
									  required:  true,
									
									
								  },
								  start: {
									  required:  true,
									
									
								  },
								  end: {
									  required:  true,
									  greaterThan: "#start"
									  
									
									
								  },
								  starttime: {
									  required:  true,
									
									
								  },
								  endtime: {
									  required:  true,
									
									  
									
									
								  },
							   },
							
						  })
						  }
						})
						</script>
					
				{% endblock %}